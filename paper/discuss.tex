\section{Discussion}

We present an entirely new approach to performing and communicating
experimental science.  Our use of
typed, functional and reactive programming overcomes at least three
long-standing issues in bioinformatics: the need for a flexible
ontology to share heterogeneous data from physiological experiments
\cite{Amari2002}, a language for describing experiments unambiguously
\cite{Murray-Rust2002}, and an equational formulation of data
provenance \cite{Pool2002}. 

The types we have presented form a linguistic framework and an
ontology for physiology. Thanks to the flexibility of parametric
polymorphism, our ontology can form the basis for the interchange of
physiological data and meta-data without imposing unnecessary
constraints on what can be shared. The ontology is non-hierarchical
and would be difficult to formulate in the various existing semantic
web ontology frameworks (Web Ontology Language \cite{owlref}, or
Resource Description Framework), which lack parametric polymorphism
and functional abstraction. Nevertheless, by specifying the categories
of mathematical objects that constitute evidence, it is an ontology in
the classical sense of cataloguing the categories within a specific
domain, and providing a vocabulary for that domain. We emphasise again
that it is an ontology of \emph{evidence}, not of the biological
entities that give rise to this evidence. It is unusual as an ontology
for scientific knowledge in being embedded in a \emph{computational}
framework, such that it can describe not only mathematical objects but
also their transformations and observations.

% HN 2010-11-24: Instead of
%
% Our mathematical definitions are less ambiguous than definitions
% written in plain English, 
% 
% to make it consistent with "unambiguous" above, I propose
%
Our mathematical definitions are unambiguous and concise, unlike
typical definitions written in natural language, and are more powerful
than those specified by graphical user interfaces or in formal
languages that lack a facility for defining abstractions. Our
framework is not only a theoretical formalism, but we also demonstrate
that it can be implemented as a very practical tool. This tool
consists of a collection of computer programs for executing
experiments and analyses, and carrying out data
management. Controlling experimentation and analysis with programs
that share data formats can be highly efficient, and eliminates many
sources of human error. Our experiment definitions have the further
advantage that they \emph{compose}; that is, more complex experiments
can be formulated by joining together elementary building blocks.

Our full approach is particularly relevant to the execution of very
complex and multi-modal experiments, which may need to be dynamically
reconfigured based on previous observations, or to disambiguate
difficult judgements about evidence \cite{Kriegeskorte2009}. Even
if used separately, however, individual aspects of CoPE can make
distinct contributions to scientific methodology â€” for instance, our
ontology for physiological evidence can be used within more
conventional programming languages or web applications that facilitate
data sharing. In a similar way, the capabilities of CoPE for executing
and analysing experiments could provide a robust core for innovative
graphical user interfaces.

A corollary of our work is that it may be possible in principle to
mechanically verify scientific inference, just as mathematical proofs
can be verified by a proof checker \cite{DeBruijn1968,
  Harrison2009}. It is of course not possible to verify particular
hypotheses about the physical world, or an organism in this way. What
might be verifiable are statements about experiments --- for instance,
that: particular variables were randomly controlled and not observed;
outcomes have not gained correlation due to the analysis procedure;
missing data are accounted for by the statistical model
\cite{Gelman2003}; errors are propagated correctly \cite{Taylor1997};
units of measurement are used consistently \cite{Kennedy1997}; there
is no ``double dipping'' \cite{Kriegeskorte2009}; and, ultimately,
that the observed data support the conclusions drawn. Statistical
analyses address some of these issues in relating observations to
parameter estimation and hypothesis testing. Without knowing
where observations come from, however, it is difficult to ascertain whether
they provide evidence for a given scientific hypothesis
\cite{Pool2002}. Experiment description languages, and the
representation of experimental observations into values of concrete
types (which may not always be real numbers), could play an important
role in such inference. It is likely that at least some aspects of
validation in physiology can be achieved with conservative extensions
of
% the calculus of physiological evidence 
CoPE integrated with statistical inference.

\begin{materials}
  We have implemented CoPE as a stand-alone programming language with
  a compiler targeting the RTAI real-time extension to the Linux
  kernel, the Comedi data acquisition library and OpenGL-accelerated
  graphics cards. Extracellular recordings from locust DCMD neurons
  were performed with silver hook electrodes wrapping exposed
  connectives in the neck as previously described \cite{Matheson2004}
  and visual stimuli were displayed on a 22'' CRT monitor at 160
  Hz. Intracellular patch-clamp recordings from spinal motor neurons
  in immobilised 2-day old zebrafish embryos were performed as
  previously described \cite{McDearmid2006}. Further information is
  given in the supplementary materials and methods. All code used to
  execute the experiments defined in CoPE and to produce Figures 1 and
  2 is available at http://github.com/glutamate/bugpan and is released
  under the GNU Public License.

\begin{comment}
\subsubsection{Author Contributions}  
T.N. designed and implemented CoPE, carried out the experiments and
data analyses, and wrote the draft of the paper. H.N. contributed to
the language design, helped clarify the semantics, and wrote several
sections of the manuscript. T.M. contributed to the design of the
experiments and the data analysis, and made extensive comments on
drafts of the manuscript. All authors obtained grant funding to
support this project as described in the acknowledgements.
\end{comment}
\end{materials}

\begin{acknowledgments} 

We would like to thank Jonathan McDearmid for help with the Zebrafish
recordings and Angus Silver, Guy Billings, Antonia Hamilton, Nick
Hartell and Rodrigo Quian Quiroga for critical comments on the
manuscript. This work was funded by a Human Frontier Science Project
fellowship to T.N., a Biotechnology and Biological Sciences Research
Council grant to T.M. and T.N., and Engineering and Physical Sciences Research
Council grants to H.N.
\end{acknowledgments}


