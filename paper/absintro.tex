
\section*{Abstract}

Experiments can be complex and produce large volumes of heterogeneous
data, which makes their execution, analysis, independent replication
and meta-analysis difficult. Here, we propose a mathematical model for
experimentation and analysis in physiology that addresses these
problems. First, we define a structure for representing physiological
observations. This structure emphasises the critical role of time in
physiology, but is flexible, in that it can carry information of any
type. Thus, we define an ontology of physiological quantities that can
describe a wide range of observations. Second, we show that
experiments themselves can be composed from time-dependent quantities,
and be expressed as purely mathematical equations that can be
manipulated algebraically. Our framework is concise, allowing entire
experiments to be defined unambiguously in a few equations. To
demonstrate the practicality and versatility of our approach, we show
the full equations for two non-trivial implemented and analysed
experiments describing visually stimulated neuronal responses and
dynamic clamp of vertebrate neurons. 

\pagebreak

\section*{Introduction}

Reproducibility is a cornerstone of the scientific method. As
scientific experiments and analysis are become increasingly complex,
reliant on computer code and produce larger volumes of data, the
feasibility of independent verification and replication has -- in
practice -- been undermined. Full disclosure of raw data and code for
experiments and analysis does not guarantee reproducibility.  For
instance, in only 8 out of 16 studies subject to this requirement and
published in \emph{Nature Genetics} could the findings be replicated
at all, and in only 2 of those, without discrepancies
\cite{Ioannidis2008} (see also \cite{Baggerly2009,
  McCullough2007}). It is often not realistic to verify that computer
code used in analyses correctly implements an intended mathematical
algorithm, yet errors can undermine a large body of work
\cite{Chang2006}.  In addition, primary data sharing is standard in
high-throughout biology, but not in fields that produce heterogeneous
data \cite{Gardner2005}, further undermining independent validation.
The combination of bias, human error, and unverified software, has led
to the suggestion that many --- perhaps most --- published research
findings are flawed \cite{Ioannidis2005, Merali2010}.

These problems suggest that it is worth investigating a
unified and transparent formalism for communication, validation, and
automation of experiments and analyses. We argue that
some of the above problems can be mitigated by a formalism that
% \emph{at once}: 
\emph{simultaneously}: (i) introduces a system of categorisation
directly relevant to the scientific field, such that scientists can
define experiments and reason about observations in familiar terms,
(ii) is machine executable, therefore unambiguous and practically
useful, and (iii) is composed exclusively of terms that directly
correspond to mathematical entities, enabling, unlike in conventional
programming languages, algebraic reasoning about procedures.
Experiments are difficult to formalise in terms of relations between
mathematical objects because they produce heterogeneous data
\cite{Tukey1962}, and because they interact with the physical
world. In creating a mathematical framework for experiments, we take
advantage of progress in embedding side effects \cite{PeytonJones2002,
  Roy2004, Wadler1995}, such as input and output, into programming
languages that can only evaluate mathematical functions
\cite{Church1941}.

Here, we define a formal framework for physiology
that satisfies the above criteria. We show that there
is a large conceptual overlap between physiological experimentation
and Functional Reactive Programming (FRP\cite{Elliott1997,
  Nilsson2002}), a concise and purely functional formulation of
time-dependent reactive computer programs. Consequently, physiological
experiments can be concisely defined in the vocabulary of
\emph{signals} and \emph{events} introduced by FRP. Such a language
does not describe the physical components of biological organisms. It
has no concept of networks, cells or proteins. Instead it describes
the observation and calculation of the mathematical objects that
constitute physiological evidence (``observations'').

Our framework provides:

(i) An explicitly defined ontology of physiological
observations. Physiological databases have not been widely
adopted\cite{Herz2008, Amari2002}, unlike in bioinformatics or
anatomy, despite many candidates \cite{Jessop2010, Teeters2008,
  Frishkoff2009, Katz2010}.  We suggest that a flexible, concise and
simple structure for physiological quantities can remedy some of the
shortcomings\cite{Gardner2005, Amari2002} of existing databases and
thus facilitate the sharing of data and meta-data \cite{Insel2003}.

(ii) A concise language for describing complex experiments and
analysis procedures in physiology using only mathematical
equations. Experimental protocols can be communicated unambiguously,
highlighting differences between studies and facilitating replication
and meta-analysis.  By construction, the provenance
\cite{Pool2002,MacKenzie-Graham2008, VanHorn2009} of \emph{any}
observation can be defined in a single equation that must include
post-acquisition processing and censure.

(iii) A new approach to validating scientific inference
\cite{Editors2003, Editors2010}. First, a concise language with a
clear mathematical denotation can be verified manually. Second, by
inspecting an experiment definition, \emph{automated} decision procedures
could verify certain statements about experiments that indicate sound
scientific practice, such as consistent units of measurement
\cite{Kennedy1997} and correct error propagation \cite{Taylor1997}.

(iv) A practical tool that is powerful and generalises to complex and
multi-modal experiments. We have implemented our framework as a new
programming language and used it for non-trivial neurophysiological
experiments and data analyses. This language can concisely express and
run experiment with stimuli defined by, for instance, differential
equations or complex animations.
