module SimulatePoissonSpikes where

use Prelude 

unifs :: Signal Real
unifs <* uniform (0,1)

maxRate = 200
tau = 0.2
baseline = 0.1
t0 = 5

only_pos x = if x > 0 then x else 0

rate x = only_pos((-(x-t0)/tau)*exp(1+(x-t0)/tau)*(maxRate-baseline))+baseline

spike = idfun ? ({: <: unifs :> < (rate <: seconds :>) :})

spike *> store ""